<!--
  Generated template for the ProfilePage page.

  See http://ionicframework.com/docs/components/#navigation for more info on
  Ionic pages and navigation.
-->
<ion-header>
  <ion-navbar>
    <ion-buttons>
      <button ion-button menuToggle>
        <ion-icon color="white" name="menu"></ion-icon>
      </button>
    </ion-buttons>
    <ion-buttons end>
      <button ion-button icon-only (click)="showSearch()" end>
        <ion-icon color="white" name="ios-search"></ion-icon>
      </button>
    </ion-buttons>
  </ion-navbar>
  </ion-header>
    <ion-content>
        <ion-row padding>
          <!-- Avatar -->
          <ion-col col-3>
            <img [src]="chosenPicture" class="avatar" alt="" onerror="this.src='./assets/imgs/default-avatar.jpg'">
          </ion-col>
          <!-- Information about user -->
          <ion-col col-6 text-center >
            <h6>{{postsCount}}</h6>
            <p no-padding no-margin>Posts</p>
          </ion-col>
          <ion-col col-3 text-center (click)="showConnections()">
            <h6>{{connections}}</h6>
            <p no-paddin no-margin>Connections</p>
          </ion-col>
        </ion-row>

        <!-- Edit/follow button -->
        <ion-row no-padding no-margin>
            <ion-col no-padding no-margin col-4></ion-col>
              <ion-col no-padding no-margin text-center col-8>
              <button (click)="showEditModal()" ion-button outline small>Edit your profile</button>
            </ion-col>
            <ion-col col-3></ion-col>
          </ion-row>

        <div padding>
            <p no-margin no-padding><b>{{user.fullName}}</b></p>
            <p no-padding no-margin class="info">{{user.myStory}}</p>
          </div>
            
            <ion-card no-padding padding-bottom no-margin class="card" *ngFor="let post of forum.posts | myposts">
                <ion-item>
                  <ion-avatar item-left>
                    <img src="{{post.avatar_image}}" onerror="this.src='./assets/imgs/default-avatar.jpg'" class="avatar-image" />
                  </ion-avatar>
                  <h2 style="font-weight: bold">{{post.user_name}}</h2>
                  <p>{{post.posted}}</p>
                </ion-item>
        
                <img *ngIf="post.image !== undefined" src="{{post.image}}">
                
                <p no-margin no-padding *ngIf="post.image !== undefined">
                    <button clear ion-button icon-only disabled class="like-btn">
                      <ion-icon no-padding isActive="false" name="ios-thumbs-up-outline" class="icon-space"></ion-icon>
                    </button>
                    <button clear ion-button icon-only (click)="addComment(post)">
                      <ion-icon no-padding isActive="false" color="black" name="ios-text-outline" class="icon-space" style="font-weight: bold"></ion-icon>
                    </button>
                    <button ion-button icon-start clear small color="danger" (click)="deletePost(post)">
                        <ion-icon name="ios-trash"></ion-icon>
                    </button>
                </p>
        
                <hr>
        
                <ion-card-content *ngIf="post.image !== undefined">
                  <p class="like-content"><ion-icon name="heart"></ion-icon> {{post.likes}} likes</p>
                  <p>{{post.text}}</p>
                  <ion-note style="font-size: 12px">
                      {{post.time_since}}
                  </ion-note>
                </ion-card-content>
                <ion-card-content text-wrap *ngIf="post.image === undefined"> 
                    {{post.text}}
                  </ion-card-content>
                  <ion-row *ngIf="post.image === undefined">
                      <ion-col>
                        <button ion-button icon-start clear small disabled>
                          <ion-icon name="ios-thumbs-up-outline"></ion-icon>
                          <div>{{post.likes}} Likes</div>
                        </button>
                      </ion-col>
                      <ion-col>
                        <button ion-button icon-start clear small (click)="seeComments(post)">
                          <ion-icon name="ios-text-outline"></ion-icon>
                          <div *ngIf="post.comments !== undefined; else showNone">{{post.comments.length}} Comments</div>
                          <ng-template #showNone>0 Comments</ng-template>
                        </button>
                      </ion-col>
                      <ion-col center text-center>
                          <button ion-button icon-start clear small color="danger" (click)="deletePost(post)">
                            <ion-icon name="ios-trash"></ion-icon>
                          </button>
                        </ion-col>
                    </ion-row>
              </ion-card>
            <!--
<ion-card>
        <ion-card-header style="align-items: center; text-align: center">
            {{user.fullName}}
        </ion-card-header>
        <ion-card-content>
          <div class="card-body">
              {{user.myStory}}
          </div>
          <div class="break"></div>
          <div class="post-header">
            Posts
          </div>
          <div class="post-body">
            <div *ngIf="postsCount === 0; else showNotEmpty">
              <p style="opacity: 0.5; text-align: center; padding-top: 15px; padding-bottom: 5px;">You have not posted anything yet</p>
            </div>
            <ng-template #showNotEmpty>
              <div>
                  <ion-item *ngFor="let post of forum.posts">
                      <ion-card *ngIf="post.uid === userData.user.uid">
                        <ion-item>
                          <ion-avatar item-start>
                            <img src="{{chosenPicture}}" onerror="this.src='./assets/imgs/default-avatar.jpg'"/>
                          </ion-avatar>
                          <h2>{{post.user_name}}</h2>
                          <p>{{post.posted}}</p>
                        </ion-item>
                        <ion-card-content text-wrap>
                          {{post.text}}
                        </ion-card-content>
                        <ion-row>
                            <ion-col>
                              <button ion-button icon-start clear small disabled>
                                <ion-icon name="ios-thumbs-up"></ion-icon>
                                <div>{{post.likes}} Likes</div>
                              </button>
                            </ion-col>
                            <ion-col>
                              <button ion-button icon-start clear small (click)="seeComments(post)">
                                <ion-icon name="ios-text"></ion-icon>
                                <div >{{post.comment_amount}} Comments</div>
                              </button>
                            </ion-col>
                            <ion-col center text-center>
                              <button ion-button icon-start clear small color="danger" (click)="deletePost(post)">
                                <ion-icon name="ios-trash"></ion-icon>
                              </button>
                            </ion-col>
                          </ion-row>
                      </ion-card>
                    </ion-item>
              </div>
            </ng-template>
          </div>
        </ion-card-content>
      </ion-card>
            -->
      
    </ion-content>
    
